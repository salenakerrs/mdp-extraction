{
    "job_name": "extrct_trf_fwtest_mssql_sample_sit_d",
    "pipeline_name": "ExtractionPipeline",
    "area_name": "test_area",
    "job_seq": 1,
    "job_info": {
        "data_source_name": "TEST_SOURCE",
        "file_name": "extrct_sit_mssql_table_d_20240228.csv",
        "data_target_type": "AZURE_STORAGE_ACCOUNT",
        "data_target_location": "fw_test/azcopy/extrct_sit_mssql_table_d_{{ ptn_yyyy }}{{ ptn_mm }}{{ ptn_dd }}.csv"
    },
    "tasks": {
        "source_data_extractor_task": {
            "module_name": "OdbcDataExtractorTask",
            "bypass_flag": false,
            "parameters": {
                "connection_name": "dgtl_fctrng",
                "query": "SELECT * V_PurRef WHERE TrnsDate == '{{pos_dt}}'",
                "extract_file_location": "{{ local_storage.filepath }}/test_area/",
                "file_name_format": {
                    "base_file_name": "extrct_sit_mssql_table_d",
                    "date_suffix": "{{ ptn_yyyy }}{{ ptn_mm }}{{ ptn_dd }}",
                    "part_suffix": "part"
                },
                "full_file_name": "{{ base_file_name }}_{{ date_suffix }}_{{ part_suffix }}-{{ part_number }}",
                "batch_size": 5,
                "allow_zero_record": true,
                "file_extension": "csv",
                "file_option": {
                    "mode": "a",
                    "newline": "",
                    "encoding": "utf-8"
                },
                "write_property": {
                    "header": true,
                    "option": {
                        "delimiter": "|",
                        "quotechar": "\"",
                        "quoting": "QUOTE_ALL",
                        "escapechar": "\\"
                    }
                }
            }
        },
        "generate_control_file_task": {
            "module_name": "OdbcControlFileGeneratorTask",
            "bypass_flag": false,
            "parameters": {
                "connection_name": "dgtl_fctrng",
                "sql_file_path": "/app_mdp/mdp/config/extraction/test_area/extrct_mssql_sit_table_d_ctl.sql",
                "extract_file_location": "{{ local_storage.filepath }}/test_area/",
                "header": true,
                "header_columns": [
                    "record_count",
                    "timestamp",
                    "pos_date"
                ],
                "file_name_format": {
                    "base_file_name": "extrct_sit_mssql_table_d",
                    "date_suffix": "{{ ptn_yyyy }}{{ ptn_mm }}{{ ptn_dd }}"
                },
                "full_file_name": "{{ base_file_name }}_{{ date_suffix }}",
                "file_extension": "ctl",
                "file_option": {
                    "mode": "a",
                    "newline": "",
                    "encoding": "utf-8"
                },
                "write_property": {
                    "header": true,
                    "option": {
                        "delimiter": "|",
                        "quotechar": "\"",
                        "quoting": "QUOTE_ALL",
                        "escapechar": "\\"
                    }
                }
            }
        },
        "azcopy_data_transfer_task": {
            "module_name": "AzCopyDataTransferTask",
            "bypass_flag": false,
            "parameters": {
                "azcopy_command": "cp",
                "source": {
                    "type": "LocalLocation",
                    "filepath": "{{ local_storage.filepath }}/test_area/extrct_sit_mssql_table_d_{{ ptn_yyyy }}{{ ptn_mm }}{{ ptn_dd }}*"
                },
                "target": {
                    "type": "ADLSLocation",
                    "account_name": "{{ mdp_inbnd.account_name }}",
                    "container_name": "{{ mdp_inbnd.container_name }}",
                    "sas_token": "{{ mdp_inbnd.sas_token }}",
                    "filepath": "{{ mdp_inbnd.filepath }}/fw_test/azcopy/"
                },
                "cleanup_flag": "Y"
            }
        }
    }
}
